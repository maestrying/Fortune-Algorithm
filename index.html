<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Алгоритм</title>
    <style>
        body { margin: 0; padding: 0; height: 100%; background-color: #313131;}
    </style>

    <script type="text/javascript" src="algorythm.js"></script>
    <script type="application/javascript">
        var voronoi = true;
        var canv = null;
        //var colors = [];
        
        function mouseX(event){	return event.clientX - event.target.offsetLeft; } // считывание позиции по горизонтали
        function mouseY(event){	return event.clientY - event.target.offsetTop; } // считывание позиции по вертикали
        
        function onLoad() {
            canv = document.getElementById("canvas"); // получаем канвас
            canv.onmousemove = onMM;
            canv.onclick = onClick;
            c = canv.getContext("2d");
            w = canv.width = window.innerWidth;
            h = canv.height = window.innerHeight;
            points = [];
            v = new Voronoi();
            
            for(i = 0; i < 10; i++) {
                points.push(new Point(Math.random() * w, Math.random() * h));
                colors.push(rndCol()); // получаем пустой канвас при перезагрузке
            }
                
            redraw();
        }
        
        function onMM(e) {
            var last = points[points.length-1];
            last.x = mouseX(e);
            last.y = mouseY(e);
            redraw();
        }
        
        function onClick(e) {
            var last = points[points.length-1];
            last.x += Math.random();
            last.y += Math.random();
            points.push(new Point(mouseX(e), mouseY(e)));
            colors.push(rndCol());
        }
        
        // очистка поля
        function resetPoints() {
            points = [points[points.length-1]];
            redraw();
        }
        
        function redraw() {
            c.fillStyle = "#313131"; // цвет бг
            c.fillRect (0, 0, w, h); // заполнение всего канваса цветом бг
            
            v.Compute(points, w, h);
            edges = v.GetEdges();
            cells = v.GetCells();
            
            if(voronoi)
            {
                c.lineWidth = 3; // толщина обводки локуса
                c.strokeStyle = "#11CBD7"; // цвет обводки локуса
                for(i = 0; i < edges.length; i++)
                {
                    var e = edges[i];
                    c.beginPath();
                    c.moveTo(e.start.x, e.start.y);
                    c.lineTo(e.end.x, e.end.y);
                    c.closePath();
                    c.stroke();
                }
            }
            
            c.fillStyle = "#604FDD"; // цвет сайта
            for(i = 0; i < points.length; i++)
            {
                var p = points[i];
                c.beginPath();
                c.arc(p.x, p.y, 4, 0, Math.PI * 2, true); // размер сайта
                c.closePath();
                c.fill();
            }
        }
        function rndCol() {
            // var letters = '0123456789ABCDEF'.split('');
            // var color = '#';
            // for (var i = 0; i < 6; i++ ) {
            //     color += letters[Math.round(Math.random() * 15)];
            // }
            // return color;
        }
    </script>
</head>
<body onload="onLoad()">
    <form style="position:absolute; z-index:1; margin-top: 10px; margin-left: 10px;">
        <input type="button" value="очистить" onclick="resetPoints();" style="width:100px; height:30px; font-size: 40px;">
    </form>
    <canvas id="canvas" width="1440" height="820"></canvas> <!-- создаем область, в которую можно внедрить 2д, 3д объекты за счет контекста -->
</body>
</html>
